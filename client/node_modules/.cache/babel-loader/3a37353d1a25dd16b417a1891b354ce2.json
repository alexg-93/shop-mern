{"ast":null,"code":"var _jsxFileName = \"/Users/alex/Documents/web/react/store/client/src/screens/OrderScreen.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { Button, Row, Col, ListGroup, Image, Card } from \"react-bootstrap\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Loader from \"../components/Loader\";\nimport Message from \"../components/Message\";\nimport { Link } from \"react-router-dom\";\nimport { PayPalButton } from \"react-paypal-button-v2/lib/index\";\nimport axios from \"axios\";\nimport { getOrderDetails, payOrder, deliverOrder } from \"../redux/actions/orderActions\";\nimport { ORDER_PAY_RESET, CART_RESET, ORDER_DETAILS_RESET, ORDER_DELIVER_RESET } from '../redux/types';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst OrderScreen = _ref => {\n  _s();\n\n  let {\n    match,\n    history\n  } = _ref;\n  const orderID = match.params.id;\n  const dispatch = useDispatch();\n  const userInfo = useSelector(state => state.userLogin.userInfo);\n  const [sdkReady, setSdkReady] = useState(false);\n  const orderDetails = useSelector(state => state.orderDetails);\n  const {\n    order_details,\n    loading,\n    error\n  } = orderDetails;\n  const orderPay = useSelector(state => state.orderPay);\n  const {\n    loading: loadingPay,\n    success: successPay\n  } = orderPay;\n  const orderDeliver = useSelector(state => state.orderDeliverReducer);\n  const {\n    loading: loadingDeliver,\n    success: successDeliver\n  } = orderDeliver;\n\n  if (!loading && order_details) {\n    const {\n      orderItems\n    } = order_details;\n    order_details.itemsPrice = orderItems.reduce((acc, item) => acc + item.price * item.qty, 0);\n    order_details.itemsPrice = Number(order_details.itemsPrice.toFixed(2));\n  }\n\n  useEffect(() => {\n    if (!userInfo) {\n      history.push('/login');\n    } //Add dynamically paypal script\n\n\n    const addPaypalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get(\"/api/config/paypal\");\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => {\n        setSdkReady(true);\n      };\n\n      document.body.appendChild(script);\n    };\n\n    if (!order_details || successPay || order_details._id !== orderID || successDeliver) {\n      dispatch({\n        type: ORDER_PAY_RESET\n      });\n      dispatch({\n        type: ORDER_DELIVER_RESET\n      });\n      dispatch(getOrderDetails(orderID));\n    } else if (!order_details.isPaid) {\n      if (!window.paypal) {\n        addPaypalScript();\n      } else {\n        setSdkReady(true);\n      }\n    }\n  }, [dispatch, orderID, successPay, successDeliver, order_details]);\n\n  const successPaymentHandler = paymentResult => {\n    dispatch(payOrder(orderID, paymentResult));\n    dispatch({\n      type: CART_RESET\n    });\n  };\n\n  const deliverHandler = () => {\n    dispatch(deliverOrder(orderID));\n  };\n\n  return loading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this) : error ? /*#__PURE__*/_jsxDEV(Message, {\n    variant: \"danger\",\n    text: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n      children: \"Order :\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this), order_details._id, /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: 8,\n        children: /*#__PURE__*/_jsxDEV(ListGroup, {\n          variant: \"flush\",\n          children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Shipping\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Address : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 103,\n                columnNumber: 17\n              }, this), order_details.shippingAddress.address, \",\", order_details.shippingAddress.city, \",\", \" \", order_details.shippingAddress.postalCode, \",\", order_details.shippingAddress.country]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 15\n            }, this), order_details.isDelivered ? /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"success\",\n              text: `Delivered on ${order_details.deliveredAt.substring(0, 16).replace(\"T0\", \" Time \")}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"danger\",\n              text: \"Not Delivered\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Customer details\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Name : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 17\n              }, this), order_details.user.name, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Email : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                href: `mailto: ${order_details.user.email}`,\n                children: order_details.user.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Payment Method\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Method : \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 17\n              }, this), order_details.paymentMethod]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 15\n            }, this), order_details.isPaid ? /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"success\",\n              text: `Paid on ${order_details.paidAt.substring(0, 16).replace(\"T0\", \" Time \")}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(Message, {\n              variant: \"danger\",\n              text: \"Not Paid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Order Items\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, this), order_details.orderItems.length === 0 ? /*#__PURE__*/_jsxDEV(Message, {\n            text: \"Order is empty\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 15\n          }, this) : order_details.orderItems.map((item, index) => /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                md: 1,\n                children: /*#__PURE__*/_jsxDEV(Image, {\n                  src: item.image,\n                  alt: item.name,\n                  fluid: true,\n                  rounded: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                children: /*#__PURE__*/_jsxDEV(Link, {\n                  to: `/product/${item.product}`,\n                  children: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                md: 4,\n                children: [item.qty, \" x $\", item.price, \" = $\", item.qty * item.price]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 19\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 4,\n        children: /*#__PURE__*/_jsxDEV(ListGroup, {\n          variant: \"flush\",\n          children: [/*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Order Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                children: \"Items\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                children: [\"$\", order_details.itemsPrice]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                children: \"Shipping\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 185,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                children: [\"$\", order_details.shippingPrice]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                children: \"Tax\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                children: [\"$\", order_details.taxPrice]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                children: \"Total\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 201,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                children: [\"$\", order_details.totalPrice]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 13\n          }, this), !order_details.isPaid && /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n            children: [loadingPay && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 30\n            }, this), !sdkReady ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 28\n            }, this) : /*#__PURE__*/_jsxDEV(PayPalButton, {\n              amount: order_details.totalPrice,\n              onSuccess: successPaymentHandler\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 15\n          }, this), userInfo && userInfo.isAdmin && order_details.isPaid && !order_details.isDelivered && /*#__PURE__*/_jsxDEV(ListGroup, {\n            children: [loadingDeliver && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 32\n            }, this), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                style: {\n                  width: '100%'\n                },\n                type: \"button\",\n                variant: \"outline-success\",\n                className: \"btn btn-block\",\n                onClick: deliverHandler,\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-truck\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 227,\n                  columnNumber: 16\n                }, this), \" Delivered\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 222,\n                columnNumber: 13\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 12\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(OrderScreen, \"qV6ULyxWFun8TY2rpG7UqCeauNs=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = OrderScreen;\nexport default OrderScreen;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderScreen\");","map":{"version":3,"sources":["/Users/alex/Documents/web/react/store/client/src/screens/OrderScreen.js"],"names":["React","useState","useEffect","Button","Row","Col","ListGroup","Image","Card","useDispatch","useSelector","Loader","Message","Link","PayPalButton","axios","getOrderDetails","payOrder","deliverOrder","ORDER_PAY_RESET","CART_RESET","ORDER_DETAILS_RESET","ORDER_DELIVER_RESET","OrderScreen","match","history","orderID","params","id","dispatch","userInfo","state","userLogin","sdkReady","setSdkReady","orderDetails","order_details","loading","error","orderPay","loadingPay","success","successPay","orderDeliver","orderDeliverReducer","loadingDeliver","successDeliver","orderItems","itemsPrice","reduce","acc","item","price","qty","Number","toFixed","push","addPaypalScript","data","clientId","get","script","document","createElement","type","src","async","onload","body","appendChild","_id","isPaid","window","paypal","successPaymentHandler","paymentResult","deliverHandler","shippingAddress","address","city","postalCode","country","isDelivered","deliveredAt","substring","replace","user","name","email","paymentMethod","paidAt","length","map","index","image","product","shippingPrice","taxPrice","totalPrice","isAdmin","width"],"mappings":"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","sourcesContent":["\nimport React, { useState, useEffect } from \"react\";\nimport { Button, Row, Col, ListGroup, Image, Card } from \"react-bootstrap\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Loader from \"../components/Loader\";\nimport Message from \"../components/Message\";\nimport { Link } from \"react-router-dom\";\nimport { PayPalButton } from \"react-paypal-button-v2/lib/index\";\nimport axios from \"axios\";\nimport { getOrderDetails,payOrder , deliverOrder } from \"../redux/actions/orderActions\";\nimport {ORDER_PAY_RESET,CART_RESET,ORDER_DETAILS_RESET ,ORDER_DELIVER_RESET} from '../redux/types'\n\n\nconst OrderScreen = ({ match ,history }) => {\n\n  const orderID = match.params.id;\n  const dispatch = useDispatch();\n\n  const userInfo = useSelector(state=>state.userLogin.userInfo)\n\n  const [sdkReady, setSdkReady] = useState(false)\n\n  const orderDetails = useSelector((state) => state.orderDetails);\n  const { order_details, loading, error } = orderDetails;\n\n  const orderPay = useSelector((state) => state.orderPay);\n  const { loading: loadingPay, success: successPay } = orderPay;\n\n  const orderDeliver = useSelector((state) => state.orderDeliverReducer);\n  const { loading: loadingDeliver, success: successDeliver } = orderDeliver;\n\n  if (!loading && order_details) {\n    const { orderItems } = order_details;\n    order_details.itemsPrice = orderItems.reduce(\n      (acc, item) => acc + item.price * item.qty,\n      0\n    );\n    order_details.itemsPrice = Number(order_details.itemsPrice.toFixed(2));\n  }\n\n  useEffect(() => {\n\n    if(!userInfo){\n      history.push('/login')\n    }\n\n    //Add dynamically paypal script\n    const addPaypalScript = async () => {\n      const { data: clientId } = await axios.get(\"/api/config/paypal\");\n      const script = document.createElement(\"script\");\n      script.type = \"text/javascript\"\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true\n      script.onload = () => {\n        setSdkReady(true)\n      };\n      document.body.appendChild(script)\n    };\n\n    if (!order_details || successPay || order_details._id !== orderID || successDeliver) {\n      dispatch({type:ORDER_PAY_RESET})\n      dispatch({type:ORDER_DELIVER_RESET})\n      dispatch(getOrderDetails(orderID));\n     \n    } else if (!order_details.isPaid) {\n      if (!window.paypal) {\n        addPaypalScript()\n      } else {\n        setSdkReady(true)\n      }\n    }\n    \n    \n\n  }, [dispatch, orderID, successPay,successDeliver, order_details]);\n\n\n  const successPaymentHandler = (paymentResult) =>{\n      dispatch(payOrder(orderID,paymentResult))\n      dispatch({type:CART_RESET})  \n  }\n\n  const deliverHandler = () =>{\n     dispatch(deliverOrder(orderID))\n     \n  }\n\n\n  return loading ? (\n    <Loader />\n  ) : error ? (\n    <Message variant=\"danger\" text={error} />\n  ) : (\n    <>\n      <strong>Order :</strong>\n      {order_details._id}\n      <Row>\n        <Col md={8}>\n          <ListGroup variant=\"flush\">\n            <ListGroup.Item>\n              <h2>Shipping</h2>\n              <p>\n                <strong>Address : </strong>\n                {order_details.shippingAddress.address},\n                {order_details.shippingAddress.city},{\" \"}\n                {order_details.shippingAddress.postalCode},\n                {order_details.shippingAddress.country}\n              </p>\n              {order_details.isDelivered ? (\n                <Message\n                  variant=\"success\"\n                  text={`Delivered on ${order_details.deliveredAt.substring(0,16).replace(\"T0\",\" Time \")}`}\n                />\n              ) : (\n                <Message variant=\"danger\" text=\"Not Delivered\" />\n              )}\n            </ListGroup.Item>\n\n            <ListGroup.Item>\n              <h2>Customer details</h2>\n              <p>\n                <strong>Name : </strong>\n                {order_details.user.name}\n                <br />\n                <strong>Email : </strong>\n                <a href={`mailto: ${order_details.user.email}`}>\n                  {order_details.user.email}\n                </a>\n              </p>\n            </ListGroup.Item>\n\n            <ListGroup.Item>\n              <h2>Payment Method</h2>\n              <p>\n                <strong>Method : </strong>\n                {order_details.paymentMethod}\n              </p>\n              {order_details.isPaid ? (\n                <Message\n                  variant=\"success\"\n                  text={`Paid on ${order_details.paidAt.substring(0,16).replace(\"T0\",\" Time \")}`}\n                />\n              ) : (\n                <Message variant=\"danger\" text=\"Not Paid\" />\n              )}\n            </ListGroup.Item>\n            <h2>Order Items</h2>\n            {order_details.orderItems.length === 0 ? (\n              <Message text=\"Order is empty\" />\n            ) : (\n              order_details.orderItems.map((item, index) => (\n                <ListGroup.Item key={index}>\n                  <Row>\n                    <Col md={1}>\n                      <Image src={item.image} alt={item.name} fluid rounded />\n                    </Col>\n                    <Col>\n                      <Link to={`/product/${item.product}`}>{item.name}</Link>\n                    </Col>\n                    <Col md={4}>\n                      {item.qty} x ${item.price} = ${item.qty * item.price}\n                    </Col>\n                  </Row>\n                </ListGroup.Item>\n              ))\n            )}\n          </ListGroup>\n        </Col>\n\n        <Col md={4}>\n          <ListGroup variant=\"flush\">\n            <ListGroup.Item>\n              <h2>Order Summary</h2>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <Row>\n                <Col>Items</Col>\n\n                <Col>${order_details.itemsPrice}</Col>\n              </Row>\n            </ListGroup.Item>\n\n            <ListGroup.Item>\n              <Row>\n                <Col>Shipping</Col>\n\n                <Col>${order_details.shippingPrice}</Col>\n              </Row>\n            </ListGroup.Item>\n\n            <ListGroup.Item>\n              <Row>\n                <Col>Tax</Col>\n\n                <Col>${order_details.taxPrice}</Col>\n              </Row>\n            </ListGroup.Item>\n\n            <ListGroup.Item>\n              <Row>\n                <Col>Total</Col>\n\n                <Col>${order_details.totalPrice}</Col>\n              </Row>\n            </ListGroup.Item>\n           \n          \n            {!order_details.isPaid && (\n              <ListGroup.Item>\n              {loadingPay && <Loader />}\n              {!sdkReady ? <Loader/> : (<PayPalButton amount={order_details.totalPrice} onSuccess={successPaymentHandler}/>)}\n              \n              </ListGroup.Item>\n            )}\n          \n          {userInfo && userInfo.isAdmin && order_details.isPaid && !order_details.isDelivered &&\n          (<ListGroup>\n          \n            {loadingDeliver && <Loader/>}\n\n            <ListGroup.Item>\n            <Button style={{width:'100%'}}\n                type=\"button\"\n                variant='outline-success'\n                 className='btn btn-block'\n                onClick={deliverHandler}\n              ><i className=\"fas fa-truck\"></i> Delivered</Button>\n            </ListGroup.Item>\n            \n          \n            \n          </ListGroup>)}\n          </ListGroup>\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nexport default OrderScreen;\n"]},"metadata":{},"sourceType":"module"}